<!DOCTYPE HTML>
<html>
<head lang="en">
  <meta charset="UTF-8">
  <style>
   body {
     margin: 0px;
      padding: 0px;
   }
   #myCanvas {
     border: 1px solid #9C9898;
   }
  </style>
  <script language="JavaScript" src="js/fabric.js"></script>
 <script>
  window.onload = function() {
    /*
    var canvas = document.getElementById("myCanvas");
    var context = canvas.getContext("2d");
    var imageObj = new Image();

    imageObj.onload = function() {
      canvas.width = imageObj.width;  // TODO: autoscale to a max canvas size
      canvas.height = imageObj.height;
      context.drawImage(imageObj, 0, 0);

    };
    imageObj.src = "../sample/deposition/paper_fig1d_magnified.png";
  */
  //document.getElementById('pick_image').addEventListener('change', image_loader, false ); // TODO implement


      image_loader("../sample/deposition/paper_fig1d_magnified.png");

  };

  function image_loader(url){
      var canvas = new fabric.Canvas('display_image');

      fabric.Image.fromURL(url, function(img){
          canvas.setWidth(img.width);
          canvas.setHeight(img.height);

          img.filters.push(new fabric.Image.filters.Grayscale());

          // apply filters and re-render canvas when done
          img.applyFilters(canvas.renderAll.bind(canvas));

          canvas.add(img);
      });

      // TODO: enable zooming
  }

  function render_file(event){
      var img_data = event.target.files[0];
      if (!img_data.type.match("image")){
          console.log("This is not an image, and cannot be displayed");
      } else {
          var url = "../sample/deposition/paper_fig1d_magnified.png";
          image_loader(url);
      }

  }

</script>
</head>
<body>
  <div>
      <canvas id="display_image"></canvas>
  </div>

  <p>Select an image to preview: <input type="file" id="pick_image" onchange="render_file()"></p>
// TODO: File picker dialog
</body>
</html>
